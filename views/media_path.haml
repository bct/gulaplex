%link{:rel => 'stylesheet', :type => 'text/css', :href => '/css/booble.css'}
%link{:rel => 'stylesheet', :type => 'text/css', :href => '/css/theme/jquery-ui-1.7.2.custom.css'}

%script{:type => 'text/javascript', :src => '/js/jquery-1.3.2.min.js' }
%script{:type => 'text/javascript', :src => '/js/jquery-ui-1.7.2.custom.min.js' }

:javascript
  var sliderPos = #{@slider_pos};
  var updatePeriod = 10 * 1000;

  function seekPercent(percent) {
    $.post("/playtime", { pos: percent + "%"});
  }

  function updatePercent() {
    $.get('/playtime', {}, function(data, textStatus) {
      $("#slider").slider('option', 'value', data);
    });

    setTimeout(updatePercent, updatePeriod);
  }

  $(document).ready(function(){
    $("#slider").slider({
      value: sliderPos,
      stop: function(event, ui) { seekPercent(ui.value); }
    });

    setTimeout(updatePercent, updatePeriod);
  });

#header
  %ul
    %li
      %a{:href => '/media/'} media
    %li
      %a{:href => '/snes/'} snes
  %strong
    %a{:href => '/img/booby.jpg'} booble

#slider

#playlist
  %strong Playlist

  %form.button{:method => 'post', :action => '/clear'}
    %input{:type => 'submit', :value => 'clear'}

  %ul
    - $mp.playlist.each do |file|
      %li= File.basename(file)

#status
  #playing
    Playing:
    = $mp.playing()
  %form.button{:method => 'post', :action => '/pause'}
    %input{:type => 'submit', :value => 'play/pause'}
  %form.button{:method => 'post', :action => '/stop'}
    %input{:type => 'submit', :value => 'stop'}
  %form.button{:method => 'post', :action => '/backward'}
    %input{:type => 'submit', :value => '<<'}
  %form.button{:method => 'post', :action => '/forward'}
    %input{:type => 'submit', :value => '>>'}

%ul
  %li
    %a{:href => '/media/' + @path.split('/')[0..-2].reject{|x|x.empty?}.join('/') } updir
  - @ds.sort.each do |d|
    %li
      %form.inline{:method => 'post', :action => '/playdir'}
        %input{:type => 'hidden', :name => 'path', :value => '/media' + d }
        %input{:type => 'submit', :value => '>'}

      %a{:href => '/media' + d }= d

%ul
  - @fs.sort.each do |f|
    %li
      %form.inline{:method => 'post', :action => '/playfile'}
        %input{:type => 'hidden', :name => 'path', :value => f }
        %input{:type => 'submit', :value => '>'}

      %span= f
